<html>
    <head>
        <title>CyPher</title>
    </head>
    <body>
        <!--Here html-->
        <!--Element : 
            Test Case 
            Test Step
            Scenario
            Test
            Run
            Action
            Value
            Data
        -->
        <div class="body">
            <div class="header">
                <!--Btn in the right top corner to run program-->
                <input type="button" value="Generate JSON" onclick="runProgram()">
            </div><br/>
            <div id="data-row">
                <!--Totla of test / row, !IMPORTANT! js use this total of row for new row-id !IMPORTANT!-->
                <i id="row-id" style="display:none">1</i>
                <div id="row-0" data-row-status="ON">
                    <!--this section is an instruciton for User on how to complete value and data section-->
                    <p id='row-0-instruction'>value : n/a | data : url</p>
                    <!--By default 1 row is present in the front-->
                    <input type="text" id="row-0-testCase" name="testCase" id="testCase" placeholder="test case">
                    <input type="text" id="row-0-testStep" name="testStep" id="testStep" placeholder="test step">
                    <input type="text" id="row-0-scenario" name="scenario" id="scenario" placeholder="scenario">
                    <input type="text" id="row-0-test" name="test" id="test" placeholder="test">
                    <select name="run" id="row-0-run">
                        <option value="true">true</option>
                        <option value="false">false</option>
                    </select>
                    <select name="action" id="row-0-action" onchange="actionInstruction('0',this.options[this.selectedIndex].getAttribute('datainstruction'))">
                        <option value="openUrl" datainstruction="value : n/a | data : url">Open URL</option>
                        <option value="viewport" datainstruction="value : desktop - mobile - n/a | data : n/a - n/a - 500x500 (custom dimension)">Change width x height</option>
                        <option value="typeText" datainstruction="value : css section | data : Text - for random email or password '@email' or '@password'">Type Text</option>
                        <option value="click" datainstruction="value : css location | data : next (text in the section if applicable) - n/a (if not applicable)">Click on</option>
                        <option value="scrollTo" datainstruction="value : footer (balise section) | data : n/a">Scroll To</option>
                        <option value="wait" datainstruction="value : n/a | data : 8 (value in second)">Pause</option>
                        <option value="capture" datainstruction="value : css section (not mandatory) | data : title (not mandatory)">Take screenshot</option>
                        <option value="verifyElementPresent" datainstruction="value : element | data : n/a">Verify if Element is present</option>
                        <option value="verifyTextContains" datainstruction="value : element | data : expected text">Verify If Text Contains</option>
                        <option value="verifyAttr" datainstruction="value : css location | data : [href][expected data]">Verify Attribute Value<//option>
                        <option value="getLinks" datainstruction="value : n/a | data : url (only 1 url per test)">Get All Links</option>
                        <option value="download_xml" datainstruction="value : n/a | data : base_url">Download sitemap.xml</option>
                        <option value="googlePageSpeed" datainstruction="value : n/a | data : url">Run Page Speed</option>
                        <option value="sourceCode" datainstruction="value : n/a | data : [head][link][hreflang][value]">Verify view source</option>
                    </select>
                    <input type="text" id="row-0-value" name="value" id="value" placeholder="value">
                    <input type="text" id="row-0-data" name="data" id="data" placeholder="data">
                    <!--Btn at the end of the row for removing it-->
                    <input type="button" value="remove-row" onclick="removeRow('row-0')">
                </div>
            </div>
            <br/>
            <div class="footer">
                <!--Btn below the last row to add another one-->
                <input type="button" value="add-row" onclick="addRow()">
            </div>
        </div>
        <!--JS Function section-->
        <script>
            //function for instruction onchange for action
            const actionInstruction=(arg_id,arg_instruction)=>{
                document.getElementById('row-'+arg_id+'-instruction').innerHTML=arg_instruction;
            }
            //Here js function add row
            const addRow=()=>{
                //get next id
                let node_id=document.getElementById('row-id').innerText;
                //set div id
                let div_id='row-'+node_id;
                //create div element+id
                let node_div=document.createElement('div');
                node_div.setAttribute('id',div_id);
                node_div.setAttribute('data-row-status','ON');
                //create row
                let new_row='<br/><p id="'+div_id+'-instruction">value : n/a | data : url</p>'
                    +'<input type="text" id="'+div_id+'-testCase" name="testCase" id="testCase" placeholder="test case">'
                    +' <input type="text" id="'+div_id+'-testStep" name="testStep" id="testStep" placeholder="test step">'
                    +' <input type="text" id="'+div_id+'-scenario" name="scenario" id="scenario" placeholder="scenario">'
                    +' <input type="text" id="'+div_id+'-test" name="test" id="test" placeholder="test">'
                    +' <select name="run" id="'+div_id+'-run">'
                        +'<option value="true">true</option>'
                        +'<option value="false">false</option>'
                    +'</select>'
                    +'<select name="action" id="'+div_id+'-action" onchange="actionInstruction(\''+node_id+'\',this.options[this.selectedIndex].getAttribute(\'datainstruction\'))">'
                        +'<option value="openUrl" datainstruction="value : n/a | data : url">Open URL</option>'
                        +'<option value="viewport" datainstruction="value : desktop - mobile - n/a | data : n/a - n/a - 500x500 (custom dimension)">Change width x height</option>'
                        +'<option value="typeText" datainstruction="value : css section | data : Text - for random email or password \'@email\' or \'@password\'">Type Text</option>'
                        +'<option value="click" datainstruction="value : css location | data : next (text in the section if applicable) - n/a (if not applicable)">Click on</option>'
                        +'<option value="scrollTo" datainstruction="value : footer (balise section) | data : n/a">Scroll To</option>'
                        +'<option value="wait" datainstruction="value : n/a | data : 8 (value in second)">Pause</option>'
                        +'<option value="capture" datainstruction="value : css section (not mandatory) | data : title (not mandatory)">Take screenshot</option>'
                        +'<option value="verifyElementPresent" datainstruction="value : element | data : n/a">Verify if Element is present</option>'
                        +'<option value="verifyTextContains" datainstruction="value : element | data : expected text">Verify If Text Contains</option>'
                        +'<option value="verifyAttr" datainstruction="value : css location | data : [href][expected data]">Verify Attribute Value<//option>'
                        +'<option value="getLinks" datainstruction="value : n/a | data : url (only 1 url per test)">Get All Links</option>'
                        +'<option value="download_xml" datainstruction="value : n/a | data : base_url">Download sitemap.xml</option>'
                        +'<option value="googlePageSpeed" datainstruction="value : n/a | data : url">Run Page Speed</option>'
                        +'<option value="sourceCode" datainstruction="value : n/a | data : [head][link][hreflang][value]">Verify view source</option>'
                    +'</select>'
                    +' <input type="text" id="'+div_id+'-value" name="value" id="value" placeholder="value">'
                    +' <input type="text" id="'+div_id+'-data" name="data" id="data" placeholder="data">'
                    +' <input type="button" value="remove-row" onclick="removeRow(\''+div_id+'\')">';
                //add div in data-row
                document.getElementById("data-row").appendChild(node_div);
                document.getElementById(div_id).innerHTML=new_row;
                //change next id in front
                document.getElementById('row-id').innerHTML=Number(node_id)+1;
            }
            //Here js function remove row
            const removeRow=(arg)=>{
                let element=document.getElementById(arg);
                element.setAttribute('data-row-status','OFF');
                element.style.display='none';
            }
            //here js function json export - run program
            const runProgram=()=>{
                let testCase='', testStep='',scenario='',test='',run='',action='',value='',data='';
                //use getTime() for different json_page id
                let page_id=new Date();
                //get total of row
                //note :: this is for all row (data-row-status="ON" and data-row-status="OFF")
                let row_length=Number(document.getElementById('row-id').innerText);
                //get data and transform it to data1/*/data2 for each input
                for(var compt=0;compt<row_length;compt++){
                    let temp_data_status=document.getElementById('row-'+compt).getAttribute('data-row-status');
                    if(temp_data_status=='ON'){
                        testCase+='/*/'+document.getElementById('row-'+compt+'-testCase').value;
                        testStep+='/*/'+document.getElementById('row-'+compt+'-testStep').value;
                        scenario+='/*/'+document.getElementById('row-'+compt+'-scenario').value;
                        test+='/*/'+document.getElementById('row-'+compt+'-test').value;
                        run+='/*/'+document.getElementById('row-'+compt+'-run').value;
                        action+='/*/'+document.getElementById('row-'+compt+'-action').value;
                        value+='/*/'+document.getElementById('row-'+compt+'-value').value;
                        data+='/*/'+document.getElementById('row-'+compt+'-data').value;
                    }
                }
                //create JSON Object
                let json_result=JSON.stringify({ 
                    testCase:testCase.substring(3),
                    testStep:testStep.substring(3),
                    scenario:scenario.substring(3),
                    test:test.substring(3),
                    run:run.substring(3),
                    action:action.substring(3),
                    value:value.substring(3),
                    data:data.substring(3)
                });
                //prepare new window for result
                let json_page = window.open("", "JSON_"+page_id.getTime()+"", "width=600,height=800");
                //send result to the new window
                json_page.document.write(json_result);
            }
        </script>
    </body>
</html>